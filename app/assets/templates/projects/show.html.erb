<div ng-controller="ShowProjectCtrl">
  <h3 class="text-center">{{project.name}}</h3>
  <div class="card">
    <div class="card-body card-padding">
      <div ng-show="showInstruments">
        <div class="btn btn-primary" ng-click="newInstrument()">New Instrument</div>
        <a ui-sref="importInstrument({id: project.id})"
           class="btn btn-primary">Import From Instruments2 CSV</a>
      </div>
      <div ng-show="showInstruments">
        <input type="search" ng-model="i.title" placeholder="Filter instruments..."
               class="form-control tm-search text-center m-1">
        <table class="table table-responsive">
          <thead>
          <tr>
            <th>Title</th>
            <th>Published</th>
            <th>Version</th>
            <th>Question Count</th>
            <th>Last updated</th>
            <th>Actions</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="instrument in instruments | filter:i">
            <td><a ui-sref='instrument({project_id: project.id, id: instrument.id})'>
              {{instrument.title}}</a>
            </td>
            <td>{{instrument.published}}</td>
            <td>{{instrument.current_version_number}}</td>
            <td>{{instrument.question_count}}</td>
            <td>{{instrument.updated_at | date:'short'}}</td>
            <td>
              <button class="btn btn-primary" ng-click="editInstrument(instrument)">
                Edit
              </button>
              <button class="btn btn-danger" ng-click="deleteInstrument(instrument)">
                Delete
              </button>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
      <div ng-hide="showInstruments">
        <div class="row m-1">
          <label class="col-md-3 control-label">Instrument Title</label>
          <div class="col-md-9">
            <input class="form-control input-sm" type="text" ng-model="instrument.title" required />
          </div>
        </div>
        <div class="row m-1">
          <label class="col-md-3 control-label">Instrument Language</label>
          <div class="col-md-9">
            <select
              ng-model="instrument.language"
              ng-options="language[1] as language[0] for language in languages"
            >
            </select>
          </div>
        </div>
        <div class="row m-1">
          <label class="col-md-3 control-label">Published</label>
          <div class="col-md-9">
            <input type="checkbox" ng-model="instrument.published" />
          </div>
        </div>
        <div class="float-right">
          <btn class="btn btn-success" ng-click="saveInstrument(instrument)">Save</btn>
        </div>
      </div>
    </div>
  </div>
</div>
